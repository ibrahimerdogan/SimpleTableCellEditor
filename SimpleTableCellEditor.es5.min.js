"use strict";function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var _createClass=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),SimpleTableCellEdition=function SimpleTableCellEdition(n,t){_classCallCheck(this,SimpleTableCellEdition);this.Elem=n;this.oldContent=$(n).html();this.oldValue=$(n).text();this.cellParams=t},SimpleTableCellEditor=function(){function n(t,i){_classCallCheck(this,n);var r=this;typeof t=="undefined"&&(t="table");this.tableId=t;this.params=$.extend({},r._GetDefaultEditorParams(),i);this.CellEdition=null;$(document).mouseup(function(n){var t=$("#"+r.tableId);t.is(n.target)||t.has(n.target).length!==0||r._FreeCurrentCell()})}return _createClass(n,[{key:"SetEditableClass",value:function(n,t){var i=this,r=$.extend({},i._GetDefaultCellParams(),t);$("#"+this.tableId).on("click","td."+n+":not(."+i.params.inEditClass+")",function(){i._EditCell(this,r)});$("#"+this.tableId).on("keydown","td."+n+"."+i.params.inEditClass,function(n){n.which===13?i._EndEditCell(this,r):n.which===27&&i._AbortEditCell(this,r)})}},{key:"_EditCell",value:function(n,t){var r,i;this._FreeCurrentCell(t);this.CellEdition=new SimpleTableCellEdition(n,t);r=$(n).text();$(n).addClass(this.params.inEditClass);$(n).html("<input type='text' style=\"width:100%; max-width:none\">");i=$(n).find("input");i.focus();i.val(r)}},{key:"_EndEditCell",value:function(n,t){this._FreeCell(n,t,!0)}},{key:"_AbortEditCell",value:function(n,t){this._FreeCell(n,t,!1)}},{key:"_FreeCell",value:function(n,t,i){var r,u;typeof $(n).length!="undefined"&&$(n).length!==0&&n!==null&&this.CellEdition!==null&&(r=$(n).find("input").val(),$(n).removeClass(this.params.inEditClass),$(n).html(""),t.validation(r)||(i=!1),i?(u=t.formatter(r),$(n).text(u),$("#"+this.tableId).trigger({type:"cell:edited",element:n,newValue:u,oldValue:this.CellEdition.oldValue})):$(n).html(this.CellEdition.oldContent),this.CellEdition=null)}},{key:"_FreeCurrentCell",value:function(){var n=this._GetCurrentEdition();n!==null&&this._EndEditCell(n.Elem,n.cellParams)}},{key:"_GetCurrentEdition",value:function(){return this.CellEdition===null?null:this.CellEdition}},{key:"_GetDefaultEditorParams",value:function(){return{inEditClass:"inEdit"}}},{key:"_GetDefaultCellParams",value:function(){return{validation:function(){return!0},formatter:function(n){return n}}}}]),n}();